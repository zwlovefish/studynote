# JAVA内存区域与内存溢出异常
JAVA虚拟机所管理的内存将包括以下几个运行时数据区域
![java虚拟机运行时数据区](../images/java虚拟机运行时数据区.png)

- 程序计数器：当前线程所执行的字节码的行号指示器
- 虚拟机栈：虚拟机描述的是java方法执行的内存模型。每个方法在执行的同时都会创建一个栈帧用于存储局部变量表，操作数栈，动态链接，方法出口等信息，每个方法从调用到直至执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈到出栈的过程，虚拟机栈也是通常所说的栈内存。
- 本地方法栈：本地方法栈为虚拟机使用到的Native方法服务
- 堆：此内存区域的唯一目的就是存放对象实例。java虚拟机规范中描述：所有的对象实例以及数组都要在堆上分配且堆可以处于物理上不连续的内存空间中，只要逻辑上是连续的即可
- 方法区：用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据
- 运行时常量池：class文件中出了有类的版本、字段、方法、接口等描述信息外，还有一项信息是常量池，用于存放编译期生成的各种字面量和符号引用，这部分内容将在类加载后进入方法区的运行时常量池中存放
- 直接内存：在jdk1.4中新加入NIO类，引入一种基于通道与缓冲区的I/O方式，它可以是使用Native函数库直接分配堆外内存，然后通过一个存储在JAVA堆中的DirectByteBuffer对象作为这块内存的引用进行操作，这样能在一些场景中提高性能，因为避免了在JAVA堆和Native堆中来回复制数据

```FLOW
start=>start:开始
op1=>operation:虚拟机遇到一条new指令
condition1=>condition:检查该指令是否能在常量池中定位到一个类的符号引用
op2=>operation:执行类加载
op3=>operation:虚拟机为新生对象分配内存(大小确定)
op4=>operation:内存空间初始化
op5=>operation:对对象进行设置
end=>end:结束

start->op1
op1->condition1
condition1(yes)->op3
condition1(no)->op2
op2->op3
op3->op4
op4->op5
op5->end
```
